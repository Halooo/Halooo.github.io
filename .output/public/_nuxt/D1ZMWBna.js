import{k as Ie,E as A,a as M}from"./BxtoV3vY.js";import{d as ne,m as ve,a as k,e as _e,s as Le,c as y,w as ue,n as me,D as pe,F as h,G as ce,R as v,H as E,J as b,Q as m,u as e,a4 as de,a3 as ze,N as S,I as x,a1 as ae,X as Ee,a2 as Se,ac as Ce,ad as Ne,M as te,T as xe,af as Oe,at as Te,L as Re,O as $e,E as Ae}from"./CCRDBSiD.js";import{b as ge,f as P,m as we,F as Be,G as Me,E as O,j as Ve,c as Xe,d as Ye,H as De,I as Fe,J as He,K as Pe,_ as ye,w as be}from"./DVvrfKR8.js";import{i as B,f as fe,e as he,k as je,S as Ke,a3 as We}from"./CwFcZstm.js";import{u as ke,k as Ge}from"./CQxnt44T.js";import{d as Je,a as Ze}from"./CYDTDHpu.js";import{d as qe}from"./z8NNEHSl.js";const Qe=(i,p)=>{if(!B||!i||!p)return!1;const s=i.getBoundingClientRect();let f;return p instanceof Element?f=p.getBoundingClientRect():f={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},s.top<f.bottom&&s.bottom>f.top&&s.right>f.left&&s.left<f.right};var Ue="Expected a function";function ie(i,p,s){var f=!0,l=!0;if(typeof i!="function")throw new TypeError(Ue);return Ie(s)&&(f="leading"in s?!!s.leading:f,l="trailing"in s?!!s.trailing:l),Je(i,p,{leading:f,maxWait:p,trailing:l})}const et=ge({urlList:{type:P(Array),default:()=>we([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:P(String)}}),tt={close:()=>!0,switch:i=>fe(i),rotate:i=>fe(i)},at=["src","crossorigin"],nt=ne({name:"ElImageViewer"}),st=ne({...nt,props:et,emits:tt,setup(i,{expose:p,emit:s}){var f;const l=i,w={CONTAIN:{name:"contain",icon:ve(Be)},ORIGINAL:{name:"original",icon:ve(Me)}},{t:se}=ke(),u=he("image-viewer"),{nextZIndex:V}=je(),C=k(),N=k([]),T=_e(),I=k(!0),c=k(l.initialIndex),R=Le(w.CONTAIN),o=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),X=k((f=l.zIndex)!=null?f:V()),oe=y(()=>{const{urlList:a}=l;return a.length<=1}),j=y(()=>c.value===0),K=y(()=>c.value===l.urlList.length-1),Y=y(()=>l.urlList[c.value]),le=y(()=>[u.e("btn"),u.e("prev"),u.is("disabled",!l.infinite&&j.value)]),W=y(()=>[u.e("btn"),u.e("next"),u.is("disabled",!l.infinite&&K.value)]),D=y(()=>{const{scale:a,deg:n,offsetX:r,offsetY:_,enableTransition:z}=o.value;let g=r/a,L=_/a;switch(n%360){case 90:case-270:[g,L]=[L,-g];break;case 180:case-180:[g,L]=[-g,-L];break;case 270:case-90:[g,L]=[-L,g];break}const $={transform:`scale(${a}) rotate(${n}deg) translate(${g}px, ${L}px)`,transition:z?"transform .3s":""};return R.value.name===w.CONTAIN.name&&($.maxWidth=$.maxHeight="100%"),$});function F(){G(),s("close")}function re(){const a=ie(r=>{switch(r.code){case A.esc:l.closeOnPressEscape&&F();break;case A.space:U();break;case A.left:ee();break;case A.up:d("zoomIn");break;case A.right:t();break;case A.down:d("zoomOut");break}}),n=ie(r=>{const _=r.deltaY||r.deltaX;d(_<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});T.run(()=>{M(document,"keydown",a),M(document,"wheel",n)})}function G(){T.stop()}function J(){I.value=!1}function Z(a){I.value=!1,a.target.alt=se("el.image.error")}function q(a){if(I.value||a.button!==0||!C.value)return;o.value.enableTransition=!1;const{offsetX:n,offsetY:r}=o.value,_=a.pageX,z=a.pageY,g=ie($=>{o.value={...o.value,offsetX:n+$.pageX-_,offsetY:r+$.pageY-z}}),L=M(document,"mousemove",g);M(document,"mouseup",()=>{L()}),a.preventDefault()}function Q(){o.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function U(){if(I.value)return;const a=Ge(w),n=Object.values(w),r=R.value.name,z=(n.findIndex(g=>g.name===r)+1)%a.length;R.value=w[a[z]],Q()}function H(a){const n=l.urlList.length;c.value=(a+n)%n}function ee(){j.value&&!l.infinite||H(c.value-1)}function t(){K.value&&!l.infinite||H(c.value+1)}function d(a,n={}){if(I.value)return;const{minScale:r,maxScale:_}=l,{zoomRate:z,rotateDeg:g,enableTransition:L}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...n};switch(a){case"zoomOut":o.value.scale>r&&(o.value.scale=Number.parseFloat((o.value.scale/z).toFixed(3)));break;case"zoomIn":o.value.scale<_&&(o.value.scale=Number.parseFloat((o.value.scale*z).toFixed(3)));break;case"clockwise":o.value.deg+=g,s("rotate",o.value.deg);break;case"anticlockwise":o.value.deg-=g,s("rotate",o.value.deg);break}o.value.enableTransition=L}return ue(Y,()=>{me(()=>{const a=N.value[0];a!=null&&a.complete||(I.value=!0)})}),ue(c,a=>{Q(),s("switch",a)}),pe(()=>{var a,n;re(),(n=(a=C.value)==null?void 0:a.focus)==null||n.call(a)}),p({setActiveItem:H}),(a,n)=>(h(),ce(Oe,{to:"body",disabled:!a.teleported},[v(xe,{name:"viewer-fade",appear:""},{default:E(()=>[b("div",{ref_key:"wrapper",ref:C,tabindex:-1,class:m(e(u).e("wrapper")),style:de({zIndex:X.value})},[b("div",{class:m(e(u).e("mask")),onClick:n[0]||(n[0]=ze(r=>a.hideOnClickModal&&F(),["self"]))},null,2),S(" CLOSE "),b("span",{class:m([e(u).e("btn"),e(u).e("close")]),onClick:F},[v(e(O),null,{default:E(()=>[v(e(Ve))]),_:1})],2),S(" ARROW "),e(oe)?S("v-if",!0):(h(),x(ae,{key:0},[b("span",{class:m(e(le)),onClick:ee},[v(e(O),null,{default:E(()=>[v(e(Xe))]),_:1})],2),b("span",{class:m(e(W)),onClick:t},[v(e(O),null,{default:E(()=>[v(e(Ye))]),_:1})],2)],64)),S(" ACTIONS "),b("div",{class:m([e(u).e("btn"),e(u).e("actions")])},[b("div",{class:m(e(u).e("actions__inner"))},[v(e(O),{onClick:n[1]||(n[1]=r=>d("zoomOut"))},{default:E(()=>[v(e(De))]),_:1}),v(e(O),{onClick:n[2]||(n[2]=r=>d("zoomIn"))},{default:E(()=>[v(e(Fe))]),_:1}),b("i",{class:m(e(u).e("actions__divider"))},null,2),v(e(O),{onClick:U},{default:E(()=>[(h(),ce(Ee(e(R).icon)))]),_:1}),b("i",{class:m(e(u).e("actions__divider"))},null,2),v(e(O),{onClick:n[3]||(n[3]=r=>d("anticlockwise"))},{default:E(()=>[v(e(He))]),_:1}),v(e(O),{onClick:n[4]||(n[4]=r=>d("clockwise"))},{default:E(()=>[v(e(Pe))]),_:1})],2)],2),S(" CANVAS "),b("div",{class:m(e(u).e("canvas"))},[(h(!0),x(ae,null,Se(a.urlList,(r,_)=>Ce((h(),x("img",{ref_for:!0,ref:z=>N.value[_]=z,key:r,src:r,style:de(e(D)),class:m(e(u).e("img")),crossorigin:a.crossorigin,onLoad:J,onError:Z,onMousedown:q},null,46,at)),[[Ne,_===c.value]])),128))],2),te(a.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ot=ye(st,[["__file","image-viewer.vue"]]);const lt=be(ot),rt=ge({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:P([String,Object])},previewSrcList:{type:P(Array),default:()=>we([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:P(String)}}),it={load:i=>i instanceof Event,error:i=>i instanceof Event,switch:i=>fe(i),close:()=>!0,show:()=>!0},ut=["src","loading","crossorigin"],ct={key:0},dt=ne({name:"ElImage",inheritAttrs:!1}),ft=ne({...dt,props:rt,emits:it,setup(i,{emit:p}){const s=i;let f="";const{t:l}=ke(),w=he("image"),se=Te(),u=qe(),V=k(),C=k(!1),N=k(!0),T=k(!1),I=k(),c=k(),R=B&&"loading"in HTMLImageElement.prototype;let o,X;const oe=y(()=>[w.e("inner"),Y.value&&w.e("preview"),N.value&&w.is("loading")]),j=y(()=>se.style),K=y(()=>{const{fit:t}=s;return B&&t?{objectFit:t}:{}}),Y=y(()=>{const{previewSrcList:t}=s;return Array.isArray(t)&&t.length>0}),le=y(()=>{const{previewSrcList:t,initialIndex:d}=s;let a=d;return d>t.length-1&&(a=0),a}),W=y(()=>s.loading==="eager"?!1:!R&&s.loading==="lazy"||s.lazy),D=()=>{B&&(N.value=!0,C.value=!1,V.value=s.src)};function F(t){N.value=!1,C.value=!1,p("load",t)}function re(t){N.value=!1,C.value=!0,p("error",t)}function G(){Qe(I.value,c.value)&&(D(),q())}const J=We(G,200,!0);async function Z(){var t;if(!B)return;await me();const{scrollContainer:d}=s;Ke(d)?c.value=d:Ae(d)&&d!==""?c.value=(t=document.querySelector(d))!=null?t:void 0:I.value&&(c.value=Ze(I.value)),c.value&&(o=M(c,"scroll",J),setTimeout(()=>G(),100))}function q(){!B||!c.value||!J||(o==null||o(),c.value=void 0)}function Q(t){if(t.ctrlKey){if(t.deltaY<0)return t.preventDefault(),!1;if(t.deltaY>0)return t.preventDefault(),!1}}function U(){Y.value&&(X=M("wheel",Q,{passive:!1}),f=document.body.style.overflow,document.body.style.overflow="hidden",T.value=!0,p("show"))}function H(){X==null||X(),document.body.style.overflow=f,T.value=!1,p("close")}function ee(t){p("switch",t)}return ue(()=>s.src,()=>{W.value?(N.value=!0,C.value=!1,q(),Z()):D()}),pe(()=>{W.value?Z():D()}),(t,d)=>(h(),x("div",{ref_key:"container",ref:I,class:m([e(w).b(),t.$attrs.class]),style:de(e(j))},[C.value?te(t.$slots,"error",{key:0},()=>[b("div",{class:m(e(w).e("error"))},Re(e(l)("el.image.error")),3)]):(h(),x(ae,{key:1},[V.value!==void 0?(h(),x("img",$e({key:0},e(u),{src:V.value,loading:t.loading,style:e(K),class:e(oe),crossorigin:t.crossorigin,onClick:U,onLoad:F,onError:re}),null,16,ut)):S("v-if",!0),N.value?(h(),x("div",{key:1,class:m(e(w).e("wrapper"))},[te(t.$slots,"placeholder",{},()=>[b("div",{class:m(e(w).e("placeholder"))},null,2)])],2)):S("v-if",!0)],64)),e(Y)?(h(),x(ae,{key:2},[T.value?(h(),ce(e(lt),{key:0,"z-index":t.zIndex,"initial-index":e(le),infinite:t.infinite,"zoom-rate":t.zoomRate,"min-scale":t.minScale,"max-scale":t.maxScale,"url-list":t.previewSrcList,"hide-on-click-modal":t.hideOnClickModal,teleported:t.previewTeleported,"close-on-press-escape":t.closeOnPressEscape,onClose:H,onSwitch:ee},{default:E(()=>[t.$slots.viewer?(h(),x("div",ct,[te(t.$slots,"viewer")])):S("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):S("v-if",!0)],64)):S("v-if",!0)],6))}});var vt=ye(ft,[["__file","image.vue"]]);const kt=be(vt);export{kt as E,ie as t};
